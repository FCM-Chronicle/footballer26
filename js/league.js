// league.js - 리그 및 팀 데이터

const LEAGUES = {
    // 모든 리그를 하나의 객체로 통합
    leagues: [
        {
            name: "K리그1",
            fullName: "K리그1",
            tier: 2,
            teams: ["울산 HD FC", "강원 FC", "김천 상무 FC", "FC 서울", "수원 FC", "포항 스틸러스", 
                    "제주 SK FC", "대전 하나 시티즌", "광주 FC", "전북 현대 모터스", "대구 FC", "FC 안양"]
        },
        {
            name: "J리그",
            fullName: "J1리그",
            tier: 2,
            teams: ["비셀 고베", "산프레체 히로시마", "마치다 젤비아", "감바 오사카", "가시마 앤틀러스", 
                    "도쿄 베르디", "FC 도쿄", "가와사키 프론탈레", "요코하마 F. 마리노스", "세레소 오사카",
                    "나고야 그램퍼스", "아비스파 후쿠오카", "우라와 레드 다이아몬즈", "교토 상가", "쇼난 벨마레",
                    "알비렉스 니가타", "가시와 레이솔", "시미즈 S펄스", "요코하마 FC", "파지아노 오카야마"]
        },
        {
            name: "터키 슈페르리가",
            fullName: "슈페르리가",
            tier: 2,
            teams: ["갈라타사라이", "페네르바체", "베식타스", "트라브존스포르", "바샥셰히르", "알란야스포르"]
        },
        {
            name: "세르비아 수페르리가",
            fullName: "수페르리가",
            tier: 2,
            teams: ["레드 스타", "파르티잔", "보이보디나", "츠르베나 즈베즈다", "라드니치키", "차카크"]
        },
        {
            name: "벨기에 프로 리그",
            fullName: "프로 리그",
            tier: 2,
            teams: ["Union SG", "Club Brugge", "RSC Anderlecht", "KAA Gent", "Sint-Truiden", "KV Mechelen",
                    "KRC Genk", "Zulte Waregem", "KVC Westerlo", "Charleroi SC", "RAAL La Louvière", 
                    "Standard Liège", "Royal Antwerp", "Cercle Brugge", "OH Leuven", "FCV Dender EH"]
        },
        {
            name: "독일 1부",
            fullName: "분데스리가",
            tier: 1,
            teams: ["바이에른 뮌헨", "RB 라이프치히", "슈투트가르트", "보루시아 도르트문트", "바이어 레버쿠젠",
                    "아인트라흐트 프랑크푸르트", "호펜하임", "1. FC 쾰른", "베르더 브레멘", "유니온 베를린",
                    "SC 프라이부르크", "VfL 볼프스부르크", "함부르크", "FC 장크트파울리", "아우크스부르크",
                    "1. FSV 마인츠 05", "1. FC 하이덴하임", "보루시아 묀헨글라트바흐"]
        },
        {
            name: "독일 2부",
            fullName: "2. 분데스리가",
            tier: 3,
            teams: ["뉘른베르크", "다름슈타트", "포르투나 뒤셀도르프", "드레스덴", "마그데부르크", "보훔",
                    "브라운슈바이크", "빌레펠트", "샬케 04", "엘페르스베르크", "카이저슬라우테른", "카를스루어 SC",
                    "홀슈타인 킬", "SC 파더보른", "그로이터 퓌르트", "프로이센 뮌스터", "하노버 96", "헤르타 BSC"]
        },
        {
            name: "스페인 1부",
            fullName: "라리가",
            tier: 1,
            teams: ["레알 마드리드", "바르셀로나", "비야레알", "에스파뇰", "아틀레티코 마드리드", "레알 소시에다드",
                    "지로나", "세비야", "레알 베티스", "아틀레틱 빌바오", "오사수나", "셀타 비고", "헤타페",
                    "레알 오비에도", "알라베스", "마요르카", "발렌시아", "라요 바예카노", "레반테", "엘체"]
        },
        {
            name: "스페인 2부",
            fullName: "세군다 디비시온",
            tier: 3,
            teams: ["레알 사라고사", "말라가", "데포르티보", "스포르팅 히혼", "라싱 산탄데르", "레알 오비에도 B"]
        },
        {
            name: "포르투갈 리그",
            fullName: "프리메이라 리가",
            tier: 2,
            teams: ["FC 포르투", "스포르팅 CP", "SL 벤피카", "질 비센테", "모레이렌스", "파말리캉",
                    "비토리아 SC", "SC 브라가", "FC 알베르카", "CD 나시오날", "FC 아로우카", "히우 아브",
                    "산타 클라라", "카사 피아 AC", "에스트렐라 아마도라", "GD 이스토릴", "CD 톤델라", "AVS FS"]
        },
        {
            name: "잉글랜드 1부",
            fullName: "프리미어리그",
            tier: 1,
            teams: ["아스널", "본머스", "토트넘 홋스퍼", "선덜랜드", "맨체스터 시티", "맨체스터 유나이티드",
                    "리버풀", "애스턴 빌라", "첼시", "크리스털 팰리스", "브렌트퍼드", "뉴캐슬 유나이티드",
                    "브라이튼", "에버튼", "리즈 유나이티드", "번리", "풀럼", "노팅엄 포레스트", 
                    "웨스트햄 유나이티드", "울버햄프턴"]
        },
        {
            name: "잉글랜드 2부",
            fullName: "챔피언십",
            tier: 3,
            teams: ["코번트리 시티", "미들즈브러", "밀월", "브리스톨 시티", "스토크 시티", "찰턴",
                    "프레스턴 노스 엔드", "헐 시티", "퀸즈 파크 레인저스", "레스터 시티", "웨스트 브롬위치 알비온",
                    "입스위치 타운", "스완지 시티", "왓포드", "버밍엄 시티", "렉섬", "더비 카운티", "포츠머스",
                    "옥스퍼드 유나이티드", "사우스햄튼", "블랙번 로버스", "셰필드 유나이티드", "노리치 시티", "셰필드 웬즈데이"]
        },
        {
            name: "프랑스 1부",
            fullName: "리그 1",
            tier: 1,
            teams: ["앙제", "오세르", "르 아브르", "랑스", "릴", "로리앙", "올랭피크 리옹", "올랭피크 드 마르세유",
                    "메스", "AS 모나코", "낭트", "OGC 니스", "파리 FC", "파리 생제르맹", "스타드 브레스투아",
                    "스타드 렌", "스트라스부르", "툴루즈 FC"]
        },
        {
            name: "이탈리아 1부",
            fullName: "세리에 A",
            tier: 1,
            teams: ["나폴리", "로마", "밀란", "인테르", "유벤투스", "아탈란타", "볼로냐", "라치오", "레체",
                    "베로나", "사수올로", "우디네세", "제노아", "칼리아리", "코모", "크레모네세", "토리노",
                    "파르마", "피사", "피오렌티나"]
        },
        {
            name: "에레디비지",
            fullName: "에레디비지",
            tier: 2,
            teams: ["페예노르트", "PSV 아인트호벤", "AZ 알크마르", "아약스", "흐로닝언", "스파르타 로테르담",
                    "NEC 네이메헌", "FC 트웬티", "위트레흐트", "시타르트", "헤이렌베인", "고 어헤드 이글스",
                    "엑셀시오르", "브레다", "즈볼레", "텔스타", "FC 폴렌담", "헤라클레스"]
        }
    ]
};

// 팀의 평균 레벨 (TSI 계산용) - 레벨 범위 50~200
const TEAM_STRENGTH = {
    // 독일 1부 (160-200)
    "바이에른 뮌헨": 200, "RB 라이프치히": 185, "슈투트가르트": 175, "보루시아 도르트문트": 195,
    "바이어 레버쿠젠": 190, "아인트라흐트 프랑크푸르트": 180, "호펜하임": 170, "1. FC 쾰른": 165,
    "베르더 브레멘": 168, "유니온 베를린": 172, "SC 프라이부르크": 170, "VfL 볼프스부르크": 175,
    "함부르크": 165, "FC 장크트파울리": 162, "아우크스부르크": 168, "1. FSV 마인츠 05": 170,
    "1. FC 하이덴하임": 165, "보루시아 묀헨글라트바흐": 178,
    
    // 스페인 1부 (160-200)
    "레알 마드리드": 200, "바르셀로나": 198, "비야레알": 175, "에스파뇰": 165, "아틀레티코 마드리드": 192,
    "레알 소시에다드": 180, "지로나": 168, "세비야": 182, "레알 베티스": 178, "아틀레틱 빌바오": 185,
    "오사수나": 170, "셀타 비고": 172, "헤타페": 165, "레알 오비에도": 168, "알라베스": 170,
    "마요르카": 165, "발렌시아": 175, "라요 바예카노": 168, "레반테": 162, "엘체": 165,
    
    // 잉글랜드 1부 (160-200)
    "맨체스터 시티": 200, "리버풀": 195, "첼시": 188, "아스널": 192, "맨체스터 유나이티드": 190,
    "토트넘 홋스퍼": 185, "뉴캐슬 유나이티드": 180, "애스턴 빌라": 178, "브라이튼": 175,
    "웨스트햄 유나이티드": 172, "본머스": 165, "선덜랜드": 168, "크리스털 팰리스": 170,
    "브렌트퍼드": 172, "에버튼": 168, "리즈 유나이티드": 170, "번리": 162, "풀럼": 170,
    "노팅엄 포레스트": 168, "울버햄프턴": 172,
    
    // 프랑스 1부 (160-200)
    "파리 생제르맹": 200, "올랭피크 드 마르세유": 182, "올랭피크 리옹": 185, "AS 모나코": 180,
    "릴": 178, "렌": 172, "스트라스부르": 168, "랑스": 170, "OGC 니스": 175, "낭트": 165,
    "앙제": 162, "오세르": 165, "르 아브르": 162, "로리앙": 165, "메스": 168, "파리 FC": 165,
    "스타드 브레스투아": 165, "툴루즈 FC": 170,
    
    // 이탈리아 1부 (160-200)
    "인테르": 198, "밀란": 195, "유벤투스": 192, "나폴리": 188, "로마": 182, "라치오": 180,
    "아탈란타": 185, "볼로냐": 172, "피오렌티나": 178, "토리노": 170, "제노아": 165,
    "우디네세": 168, "베로나": 165, "레체": 162, "사수올로": 168, "칼리아리": 165,
    "코모": 162, "크레모네세": 165, "파르마": 168, "피사": 165,
    
    // K리그1 (110-140)
    "울산 HD FC": 140, "전북 현대 모터스": 135, "포항 스틸러스": 130, "FC 서울": 128,
    "수원 FC": 125, "제주 SK FC": 122, "강원 FC": 120, "김천 상무 FC": 118,
    "대전 하나 시티즌": 120, "광주 FC": 118, "대구 FC": 122, "FC 안양": 115,
    
    // J리그 (110-140)
    "가와사키 프론탈레": 138, "요코하마 F. 마리노스": 135, "우라와 레드 다이아몬즈": 132,
    "비셀 고베": 130, "FC 도쿄": 128, "감바 오사카": 125, "세레소 오사카": 125,
    "나고야 그램퍼스": 122, "가시마 앤틀러스": 128, "산프레체 히로시마": 120,
    "도쿄 베르디": 118, "마치다 젤비아": 115, "아비스파 후쿠오카": 120, "교토 상가": 118,
    "쇼난 벨마레": 115, "알비렉스 니가타": 115, "가시와 레이솔": 118, "시미즈 S펄스": 115,
    "요코하마 FC": 112, "파지아노 오카야마": 110,
    
    // 터키 슈페르리가 (110-140)
    "갈라타사라이": 140, "페네르바체": 138, "베식타스": 135, "트라브존스포르": 125,
    "바샥셰히르": 120, "알란야스포르": 115,
    
    // 세르비아 수페르리가 (110-135)
    "레드 스타": 135, "파르티잔": 130, "보이보디나": 120, "츠르베나 즈베즈다": 118,
    "라드니치키": 115, "차카크": 112,
    
    // 벨기에 프로 리그 (110-140)
    "Club Brugge": 138, "Union SG": 135, "RSC Anderlecht": 132, "KRC Genk": 128, "Royal Antwerp": 125,
    "KAA Gent": 122, "Standard Liège": 120, "KV Mechelen": 118, "Sint-Truiden": 115, "Cercle Brugge": 118,
    "OH Leuven": 115, "Zulte Waregem": 115, "KVC Westerlo": 112, "Charleroi SC": 115, "RAAL La Louvière": 110,
    "FCV Dender EH": 110,
    
    // 포르투갈 리그 (110-145)
    "FC 포르투": 145, "SL 벤피카": 145, "스포르팅 CP": 142, "SC 브라가": 135, "비토리아 SC": 125,
    "질 비센테": 120, "모레이렌스": 118, "파말리캉": 118, "FC 아로우카": 115, "산타 클라라": 115,
    "CD 나시오날": 115, "히우 아브": 112, "카사 피아 AC": 112, "에스트렐라 아마도라": 110,
    "FC 알베르카": 115, "GD 이스토릴": 110, "CD 톤델라": 110, "AVS FS": 110,
    
    // 에레디비지 (110-145)
    "아약스": 145, "PSV 아인트호벤": 145, "페예노르트": 142, "AZ 알크마르": 135, "위트레흐트": 125,
    "FC 트웬티": 122, "NEC 네이메헌": 118, "스파르타 로테르담": 120, "흐로닝언": 115,
    "헤이렌베인": 118, "시타르트": 115, "고 어헤드 이글스": 112, "엑셀시오르": 112, "브레다": 110,
    "즈볼레": 110, "텔스타": 108, "FC 폴렌담": 108, "헤라클레스": 110,
    
    // 독일 2부 (80-110)
    "샬케 04": 110, "하노버 96": 108, "헤르타 BSC": 108, "홀슈타인 킬": 105, "SC 파더보른": 102,
    "뉘른베르크": 100, "포르투나 뒤셀도르프": 105, "카이저슬라우테른": 98, "브라운슈바이크": 95,
    "그로이터 퓌르트": 100, "카를스루어 SC": 98, "다름슈타트": 95, "드레스덴": 92, "마그데부르크": 95,
    "보훔": 100, "빌레펠트": 98, "엘페르스베르크": 90, "프로이센 뮌스터": 92,
    
    // 스페인 2부 (80-110)
    "레알 사라고사": 105, "말라가": 100, "데포르티보": 102, "스포르팅 히혼": 98,
    "라싱 산탄데르": 95, "레알 오비에도 B": 85,
    
    // 잉글랜드 2부 (80-115)
    "레스터 시티": 115, "사우스햄튼": 112, "셰필드 유나이티드": 110, "리즈 유나이티드": 108,
    "웨스트 브롬위치 알비온": 105, "미들즈브러": 100, "노리치 시티": 100, "블랙번 로버스": 100,
    "코번트리 시티": 98, "입스위치 타운": 98, "밀월": 95, "브리스톨 시티": 98, "스토크 시티": 95,
    "찰턴": 90, "프레스턴 노스 엔드": 95, "헐 시티": 92, "퀸즈 파크 레인저스": 92,
    "스완지 시티": 95, "왓포드": 98, "버밍엄 시티": 90, "렉섬": 88, "더비 카운티": 92,
    "포츠머스": 90, "옥스퍼드 유나이티드": 88, "셰필드 웬즈데이": 92
};


// 리그 티어 찾기
function getLeagueTier(leagueName) {
    for (let league of LEAGUES.leagues) {
        if (league.name === leagueName || league.fullName === leagueName) {
            return league.tier;
        }
    }
    return null;
}

// 팀이 속한 리그 찾기
function getTeamLeague(teamName) {
    for (let league of LEAGUES.leagues) {
        if (league.teams.includes(teamName)) {
            return league.name;
        }
    }
    return null;
}

// 같은 리그의 랜덤 팀 가져오기
function getRandomOpponent(playerTeam, leagueName) {
    for (let league of LEAGUES.leagues) {
        if (league.name === leagueName) {
            const teams = league.teams.filter(t => t !== playerTeam);
            return teams[Math.floor(Math.random() * teams.length)];
        }
    }
    return "상대 팀";
}

// 이적 가능한 팀 목록 (플레이어 레벨 기반)
function getTransferTargets(playerLevel, currentTier) {
    const targets = [];
    
    // 레벨에 따른 이적 가능 리그
    LEAGUES.leagues.forEach(league => {
        // 현재 리그보다 높은 티어나 같은 티어의 더 좋은 팀
        const shouldConsiderLeague = 
            (league.tier < currentTier) || // 상위 티어
            (league.tier === currentTier && league.name !== game.player.league); // 같은 티어 다른 리그
        
        if (shouldConsiderLeague) {
            league.teams.forEach(team => {
                const teamStrength = TEAM_STRENGTH[team];
                if (teamStrength) {
                    // 플레이어 레벨과 팀 전력 비교
                    const levelDiff = Math.abs(teamStrength - playerLevel);
                    
                    // 레벨 차이가 50 이내이고, 팀이 현재 팀보다 강하거나 비슷한 경우
                    const currentTeamStrength = TEAM_STRENGTH[game.player.team] || 80;
                    if (levelDiff <= 50 && teamStrength >= currentTeamStrength - 10) {
                        targets.push({
                            team: team,
                            league: league.name,
                            tier: league.tier,
                            strength: teamStrength,
                            compatibility: 100 - levelDiff // 호환성 점수
                        });
                    }
                }
            });
        }
    });
    
    // 호환성 순으로 정렬하고 랜덤하게 3개 선택
    targets.sort((a, b) => b.compatibility - a.compatibility);
    const topTargets = targets.slice(0, 10); // 상위 10개 중에서
    const shuffled = topTargets.sort(() => 0.5 - Math.random());
    return shuffled.slice(0, 3);
}

// 시작 가능한 3부 리그 팀 목록
function getStarterTeams() {
    const starterLeagues = LEAGUES.leagues.filter(l => l.tier === 3);
    const teams = [];
    starterLeagues.forEach(league => {
        league.teams.forEach(team => {
            teams.push({
                team: team,
                league: league.name,
                fullName: league.fullName
            });
        });
    });
    return teams;
}